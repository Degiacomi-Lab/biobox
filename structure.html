
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Single Structures &#8212; biobox 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Assemblies" href="assembly.html" />
    <link rel="prev" title="BiobOx’s documentation" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="assembly.html" title="Assemblies"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="BiobOx’s documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">biobox 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Single Structures</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="single-structures">
<h1>Single Structures<a class="headerlink" href="#single-structures" title="Permalink to this headline">¶</a></h1>
<p>The main data structure in BiobOx is the <a class="reference internal" href="#structure.Structure" title="structure.Structure"><code class="xref py py-func docutils literal notranslate"><span class="pre">Structure</span></code></a> class, which handles collections of 3D points.
Points are stored in a MxNx3 <strong>coordinates array</strong>, where M is the number of alternative points arrangements, and N is the amount of points.</p>
<p>At any moment, one of the loaded points conformations is considered to be the active one (a.k.a. <strong>current</strong>).
Any rototranslation or measuring operation will be performed on the current structure only.
Some methods, e.g. <a class="reference internal" href="#structure.Structure.rmsd" title="structure.Structure.rmsd"><code class="xref py py-func docutils literal notranslate"><span class="pre">rmsd</span></code></a> allow comparing different conformations, independently from which is the current one.</p>
<p>The current conformation in the coordinates array can be changed by calling the <a class="reference internal" href="#structure.Structure.set_current" title="structure.Structure.set_current"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_current</span></code></a> method (altering the Structure’s <strong>current</strong> attribute).
For comfort, the current conformation is accessible in the <strong>points</strong> Nx3 array, where:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="p">]</span>
</pre></div>
</div>
<p>Points attributes are stored in a pandas <strong>dataframe</strong>. For instance, self.data[“radius”] contains each point’s radius.
A property of the whole point cloud can be stored in a properties dictionary (e.g. self.properties[“center”]).</p>
<p>Several <a class="reference internal" href="#structure.Structure" title="structure.Structure"><code class="xref py py-func docutils literal notranslate"><span class="pre">Structure</span></code></a> subclasses are available (<a class="reference internal" href="#molecule.Molecule" title="molecule.Molecule"><code class="xref py py-func docutils literal notranslate"><span class="pre">Molecule</span></code></a>, <a class="reference internal" href="#convex.Ellipsoid" title="convex.Ellipsoid"><code class="xref py py-func docutils literal notranslate"><span class="pre">Ellipsoid</span></code></a>, <a class="reference internal" href="#convex.Cylinder" title="convex.Cylinder"><code class="xref py py-func docutils literal notranslate"><span class="pre">Cylinder</span></code></a>, <a class="reference internal" href="#convex.Cone" title="convex.Cone"><code class="xref py py-func docutils literal notranslate"><span class="pre">Cone</span></code></a>, <a class="reference internal" href="#convex.Sphere" title="convex.Sphere"><code class="xref py py-func docutils literal notranslate"><span class="pre">Sphere</span></code></a>, <a class="reference internal" href="#convex.Prism" title="convex.Prism"><code class="xref py py-func docutils literal notranslate"><span class="pre">Prism</span></code></a>, <a class="reference internal" href="#density.Density" title="density.Density"><code class="xref py py-func docutils literal notranslate"><span class="pre">Density</span></code></a>, see below).</p>
<section id="module-structure">
<span id="structure"></span><h2>Structure<a class="headerlink" href="#module-structure" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="structure.Structure">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">shape=(2,</span> <span class="pre">0),</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure" title="Permalink to this definition">¶</a></dt>
<dd><p>A Structure consists of an ensemble of points in 3D space, and metadata associated to each of them.</p>
<p>Point coordinates and properties data structures are first initialized.
properties is a dictionary initially containing an entry for ‘center’ (center of geometry) and ‘radius’ (average radius of points).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – coordinates data structure as a mxnx3 numpy array (alternative conformation x atom x 3D coordinate). nx3 numpy array can be supplied, in case a single conformation is present.</p></li>
<li><p><strong>r</strong> – average radius of every point in dataset (float), or radius of every point (numpy array)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.add_xyz">
<span class="sig-name descname"><span class="pre">add_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.add_xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.add_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>add a new alternative conformation to the database</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coords</strong> – array of 3D points, or array of arrays of 3D points (in case multiple alternative coordinates must be added at the same time)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.align_axes">
<span class="sig-name descname"><span class="pre">align_axes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.align_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.align_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Align structure on its principal axes.</p>
<p>First principal axis aligned along x, second along y and third along z.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.apply_transformation">
<span class="sig-name descname"><span class="pre">apply_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.apply_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.apply_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>apply a 3x3 transformation matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> – 3x3 transformation matrix (2D numpy array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.center_to_origin">
<span class="sig-name descname"><span class="pre">center_to_origin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.center_to_origin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.center_to_origin" title="Permalink to this definition">¶</a></dt>
<dd><p>move the structure so that its center of geometry is at the origin.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>remove all the coordinates and empty metadata</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.convex_hull">
<span class="sig-name descname"><span class="pre">convex_hull</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.convex_hull"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.convex_hull" title="Permalink to this definition">¶</a></dt>
<dd><p>compute Structure’s convex Hull using QuickHull algorithm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Qhull available only on scipy &gt;=0.12</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#structure.Structure" title="structure.Structure"><code class="xref py py-func docutils literal notranslate"><span class="pre">Structure</span></code></a> object, containing the coordinates of vertices composing the convex hull</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="structure.Structure.coordinates">
<span class="sig-name descname"><span class="pre">coordinates</span></span><a class="headerlink" href="#structure.Structure.coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy array containing an ensemble of alternative coordinates in 3D space</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="structure.Structure.current">
<span class="sig-name descname"><span class="pre">current</span></span><a class="headerlink" href="#structure.Structure.current" title="Permalink to this definition">¶</a></dt>
<dd><p>index of currently selected conformation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="structure.Structure.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#structure.Structure.data" title="Permalink to this definition">¶</a></dt>
<dd><p>metadata about each atom (pandas Dataframe)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.delete_xyz">
<span class="sig-name descname"><span class="pre">delete_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.delete_xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.delete_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>remove one conformation from the conformations database.</p>
<p>the new current conformation will be the previous one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – alternative coordinates set to remove</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.get_center">
<span class="sig-name descname"><span class="pre">get_center</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.get_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.get_center" title="Permalink to this definition">¶</a></dt>
<dd><p>compute protein center of geometry (also assigns it to self.properties[“center”] key).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.get_density">
<span class="sig-name descname"><span class="pre">get_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_half_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.get_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.get_density" title="Permalink to this definition">¶</a></dt>
<dd><p>generate density map from points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> – size of cubic voxels, in Angstrom</p></li>
<li><p><strong>sigma</strong> – gaussian kernel sigma</p></li>
<li><p><strong>kernel_half_width</strong> – kernel half width, in voxels</p></li>
<li><p><strong>buff</strong> – padding to add at points cloud boundaries</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#density.Density" title="density.Density"><code class="xref py py-func docutils literal notranslate"><span class="pre">Density</span></code></a> object, containing a simulated density map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.get_principal_axes">
<span class="sig-name descname"><span class="pre">get_principal_axes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.get_principal_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.get_principal_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>compute Structure’s principal axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>3x3 numpy array, containing the 3 principal axes ranked from smallest to biggest.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.get_size">
<span class="sig-name descname"><span class="pre">get_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.get_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the dimensions of the object along x, y and z.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.get_xyz">
<span class="sig-name descname"><span class="pre">get_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.get_xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.get_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>get points coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>indices</strong> – indices of points to select. If none is provided, all points coordinates are returned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coordinates of all points indexed by the provided indices list, or all of them if no list is provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.pca">
<span class="sig-name descname"><span class="pre">pca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.pca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.pca" title="Permalink to this definition">¶</a></dt>
<dd><p>compute Principal Components Analysis (PCA) on specific points within all the alternative coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>components</strong> – eigenspace dimensions</p></li>
<li><p><strong>indices</strong> – points indices to be considered for PCA</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array of projection of each conformation into the n-dimensional eigenspace</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sklearn PCA object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="structure.Structure.points">
<span class="sig-name descname"><span class="pre">points</span></span><a class="headerlink" href="#structure.Structure.points" title="Permalink to this definition">¶</a></dt>
<dd><p>pointer to currently selected conformation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="structure.Structure.properties">
<span class="sig-name descname"><span class="pre">properties</span></span><a class="headerlink" href="#structure.Structure.properties" title="Permalink to this definition">¶</a></dt>
<dd><p>collection of properties. By default, ‘center’ (geometric center of the Structure) is defined</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.rmsd">
<span class="sig-name descname"><span class="pre">rmsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.rmsd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the RMSD between two structures in alternative coordinates ensemble.
uses Kabsch alignement algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – index of the first structure</p></li>
<li><p><strong>j</strong> – index of the second structure</p></li>
<li><p><strong>points_index</strong> – if set, only specific points will be considered for comparison</p></li>
<li><p><strong>full</strong> – if True, RMSD an rotation matrx are returned, RMSD only otherwise</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RMSD of the two structures. If full is True, the rotation matrix is also returned</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.rmsd_distance_matrix">
<span class="sig-name descname"><span class="pre">rmsd_distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.rmsd_distance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.rmsd_distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>compute distance matrix between structures (using RMSD as metric).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points_index</strong> – if set, only specific points will be considered for comparison</p></li>
<li><p><strong>flat</strong> – if True, returns flattened distance matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RMSD distance matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.rmsd_one_vs_all">
<span class="sig-name descname"><span class="pre">rmsd_one_vs_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.rmsd_one_vs_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.rmsd_one_vs_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the RMSD between all structures with respect of a reference structure.
uses Kabsch alignement algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_index</strong> – index of reference structure in conformations database</p></li>
<li><p><strong>points_index</strong> – if set, only specific points will be considered for comparison</p></li>
<li><p><strong>align</strong> – if set to true, all conformations will be aligned to reference (note: cannot be undone!)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RMSD of all structures with respect of reference structure (in a numpy array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.rmsf">
<span class="sig-name descname"><span class="pre">rmsf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.rmsf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.rmsf" title="Permalink to this definition">¶</a></dt>
<dd><p>compute Root Mean Square Fluctuation (RMSF) of selected atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> – indices of points for which RMSF will be calculated. If no indices list is provided, RMSF of all points will be calculated.</p></li>
<li><p><strong>step</strong> – timestep between two conformations (useful when using conformations extracted from molecular dynamics)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy aray with RMSF of all provided indices, in the same order</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.rotate">
<span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.rotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>rotate the structure provided angles of rotation around x, y and z axes (in degrees).</p>
<p>This is a rotation with respect of the origin.
Make sure that the center of your structure is at the origin, if you don’t want to get a translation as well!
rotating an object being not centered requires to first translate the ellipsoid at the origin, rotate it, and bringing it back.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – rotation around x axis</p></li>
<li><p><strong>y</strong> – rotation around y axis</p></li>
<li><p><strong>z</strong> – rotation around z axis</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.rotation_matrix">
<span class="sig-name descname"><span class="pre">rotation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.rotation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>compute matrix needed to rotate the system around an arbitrary axis (using Euler-Rodrigues formula).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> – 3d vector (numpy array), representing the axis around which to rotate</p></li>
<li><p><strong>theta</strong> – desired rotation angle</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>3x3 rotation matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.set_current">
<span class="sig-name descname"><span class="pre">set_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.set_current"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.set_current" title="Permalink to this definition">¶</a></dt>
<dd><p>select current frame (place frame pointer at desired position)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pos</strong> – number of alternative conformation (starting from 0)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.set_xyz">
<span class="sig-name descname"><span class="pre">set_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.set_xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.set_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>set point coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coords</strong> – array of 3D points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.translate">
<span class="sig-name descname"><span class="pre">translate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.translate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>translate the whole structure by a given amount.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – translation around x axis</p></li>
<li><p><strong>y</strong> – translation around y axis</p></li>
<li><p><strong>z</strong> – translation around z axis</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="structure.Structure.write_pdb">
<span class="sig-name descname"><span class="pre">write_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structure.html#Structure.write_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#structure.Structure.write_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>write a multi PDB file where every point is a sphere. VdW radius is written into beta factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – name of file to output</p></li>
<li><p><strong>index</strong> – list of frame indices to write to file. By default, a multipdb with all frames will be produced.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-molecule">
<span id="molecule"></span><h2>Molecule<a class="headerlink" href="#module-molecule" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="molecule.Molecule">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Molecule</span></span><a class="reference internal" href="_modules/molecule.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">biobox.classes.structure.Structure</span></code></p>
<p>Subclass of <a class="reference internal" href="#structure.Structure" title="structure.Structure"><code class="xref py py-func docutils literal notranslate"><span class="pre">Structure</span></code></a>, allows reading, manipulating and analyzing molecular structures.</p>
<p>At instantiation, properties associated to every individual atoms are stored in a pandas Dataframe self.data.
The columns of the self.data have the following names:
atom, index, name, resname, chain, resid, beta, occupancy, atomtype, radius, charge.</p>
<p>self.knowledge contains a knowledge base about atoms and residues properties. Default values are:</p>
<ul class="simple">
<li><p>‘residue_mass’ property stores the average mass for most common aminoacids (values from Expasy website)</p></li>
<li><p>‘atom_vdw’ vdw radius of common atoms</p></li>
<li><p>‘atom_mass’ mass of common atoms</p></li>
</ul>
<p>The knowledge base can be edited. For instance, to add information about residue “TST” mass in molecule M type: M.knowledge[‘mass_residue’][“TST”]=142.42</p>
<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.apply_biomatrix">
<span class="sig-name descname"><span class="pre">apply_biomatrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.apply_biomatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.apply_biomatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>if biomatrix information is provided, generate a new molecule with all symmetry operators applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new Molecule containing several copies of the current Molecule, arranged according to BIOMT statements contained in pdb, or -1 if no transformation matrix is provided</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.apply_symmetry">
<span class="sig-name descname"><span class="pre">apply_symmetry</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.apply_symmetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.apply_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>if symmetry information is provided, generate a new molecule with all symmetry operators applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new Molecule containing several copies of the current Molecule, arranged according to SMTRY statements contained in pdb, or -1 if no transformation matrix is provided</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.assign_atomtype">
<span class="sig-name descname"><span class="pre">assign_atomtype</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.assign_atomtype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.assign_atomtype" title="Permalink to this definition">¶</a></dt>
<dd><p>guess atomtype from atom names</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.atomignore">
<span class="sig-name descname"><span class="pre">atomignore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_resname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.atomignore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.atomignore" title="Permalink to this definition">¶</a></dt>
<dd><p>Select specific atoms that do not match a specific query (chain, residue ID and atom name).
Useful to remove from a molecule atoms unwanted for further analysis, alternative conformations, etc…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain</strong> – chain name (accepts * as wildcard). Can also be a list or numpy array of strings.</p></li>
<li><p><strong>res</strong> – residue ID (accepts * as wildcard). Can also be a list or numpy array of of int.</p></li>
<li><p><strong>atom</strong> – atom name (accepts * as wildcard). Can also be a list or numpy array of strings.</p></li>
<li><p><strong>get_index</strong> – if set to True, returns the indices of atoms in self.points array (and self.data)</p></li>
<li><p><strong>use_resname</strong> – if set to True, consider information in “res” variable as resnames, and not resids</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coordinates of the selected points not matching the query, if get_index is set to true, their indices in self.points array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.atomselect">
<span class="sig-name descname"><span class="pre">atomselect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_resname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.atomselect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.atomselect" title="Permalink to this definition">¶</a></dt>
<dd><p>Select specific atoms in the protein providing chain, residue ID and atom name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain</strong> – selection of a specific chain name (accepts * as wildcard). Can also be a list or numpy array of strings.</p></li>
<li><p><strong>res</strong> – residue ID of desired atoms (accepts * as wildcard). Can also be a list or numpy array of of int.</p></li>
<li><p><strong>atom</strong> – name of desired atom (accepts * as wildcard). Can also be a list or numpy array of strings.</p></li>
<li><p><strong>get_index</strong> – if set to True, returns the indices of selected atoms in self.points array (and self.data)</p></li>
<li><p><strong>use_resname</strong> – if set to True, consider information in “res” variable as resnames, and not resids</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coordinates of the selected points and, if get_index is set to true, their indices in self.points array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.beta_factor_from_rmsf">
<span class="sig-name descname"><span class="pre">beta_factor_from_rmsf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.beta_factor_from_rmsf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.beta_factor_from_rmsf" title="Permalink to this definition">¶</a></dt>
<dd><p>estimate atoms beta factor on the base of their RMSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> – indices of atoms of interest. If not set all atoms will be considered.</p></li>
<li><p><strong>step</strong> – timestep between two conformations (useful when using conformations extracted from molecular dynamics)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_atoms_ccs">
<span class="sig-name descname"><span class="pre">get_atoms_ccs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_atoms_ccs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_atoms_ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>return array with atomic CCS radii of every atom in molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCS in Angstrom^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_couples">
<span class="sig-name descname"><span class="pre">get_couples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_couples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_couples" title="Permalink to this definition">¶</a></dt>
<dd><p>given a list of indices, compute the all-vs-all distance and return only couples below a given cutoff distance</p>
<p>useful for the detection of disulfide bridges or linkable sites via cross-linking (approximation, supposing euclidean distances)’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> – indices of atoms to check.</p></li>
<li><p><strong>cutoff</strong> – minimal distance to consider a couple as linkable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nx3 numpy array containing, for every valid connection, id of first atom, id of second atom and distance between the two.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return information about atoms of interest (i.e., slice the data DataFrame)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> – list of indices, if not provided all atom data is returned</p></li>
<li><p><strong>columns</strong> – list of columns (e.g. [“resname”, “resid”, “chain”]), if not provided all columns are returned</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array containing a slice of molecule’s data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_dipole_density">
<span class="sig-name descname"><span class="pre">get_dipole_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dipole_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vox_in_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eqn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">310.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilonE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">54.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_dipole_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_dipole_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to generate an electron density map based on a voxel grid of dipole vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dipole_map</strong> – The dipole map input. Can be generated with get_dipole_map above</p></li>
<li><p><strong>orig</strong> – Origin points for voxel grid</p></li>
<li><p><strong>min_val</strong> – Minimum coordinates of edge points for the voxel grid (i.e. a single x, y, z point defining the start point of the grid to match with the multipdb)</p></li>
<li><p><strong>V</strong> – Volume of a voxel (can be found by resolution**3, but left blank in case later version institute a sphere)</p></li>
<li><p><strong>outname</strong> – Name of electron density map file produced</p></li>
<li><p><strong>vox_in_window</strong> – Amount of surrounding space to contribute to local dipole. vox_in_window * resolution gives window size (in Ang.)</p></li>
<li><p><strong>eqn</strong> – Equation mode to model the electron density</p></li>
<li><p><strong>T</strong> – Temperature of MD</p></li>
<li><p><strong>P</strong> – Pressure of MD</p></li>
<li><p><strong>epsilonE</strong> – Continuum dielectric surrounding the protein</p></li>
<li><p><strong>resolution</strong> – Desired resolution of voxel</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_dipole_map">
<span class="sig-name descname"><span class="pre">get_dipole_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pqr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vox_in_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_dipole_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dipole_map.tcl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_dipole_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_dipole_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for generating dipole maps to be used for electron density map generation. Also prints a dipole map as a result (and if desired). It calls a cython code in lib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orig</strong> – Origin points for voxel grid</p></li>
<li><p><strong>pqr</strong> – PQR file for self. Can be generated by calling pdb2pqr above</p></li>
<li><p><strong>time_start</strong> – First frame to parse in multipdb</p></li>
<li><p><strong>time_end</strong> – Last frame to parse in multipdb</p></li>
<li><p><strong>resolution</strong> – Desired resolution of voxel</p></li>
<li><p><strong>vox_in_window</strong> – Amount of surrounding space to contribute to local dipole. vox_in_window * resolution gives window size (in Ang.)</p></li>
<li><p><strong>write_dipole_map</strong> – Write a dipole map in TCL format to be read in via VMD.</p></li>
<li><p><strong>fname</strong> – Name of desired dipole map to be written</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_electrostatics">
<span class="sig-name descname"><span class="pre">get_electrostatics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdw_kernel_half_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elect_kernel_half_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_electrostatics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_electrostatics" title="Permalink to this definition">¶</a></dt>
<dd><p>generate electrostatics map from points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> – size of cubic voxels, in Angstrom</p></li>
<li><p><strong>buff</strong> – padding to add at points cloud boundaries</p></li>
<li><p><strong>threshold</strong> – Threshold used for removing mass occupied space from the electron density map</p></li>
<li><p><strong>vdw_kernel_half_width</strong> – kernel half width, in voxels</p></li>
<li><p><strong>elect_kernel_half_width</strong> – kernel half width, in voxels</p></li>
<li><p><strong>chain</strong> – select chain to use, default all chains</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>positive <a class="reference internal" href="#density.Density" title="density.Density"><code class="xref py py-func docutils literal notranslate"><span class="pre">Density</span></code></a> object</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>negative <a class="reference internal" href="#density.Density" title="density.Density"><code class="xref py py-func docutils literal notranslate"><span class="pre">Density</span></code></a> object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mass density object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_mass_by_atom">
<span class="sig-name descname"><span class="pre">get_mass_by_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_resname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_mass_by_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_mass_by_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>compute protein mass using atoms in pdb</p>
<p>sum the mass of all atoms (using a knowledge base of atom masses in Dalton)
The knowledge base can be expanded or edited by adding or editing entries to the molecule’s mass dictionary, e.g. to add the atom “PI” mass in molecule M type: M.knowledge[‘atom_mass’][“PI”]=3.141592</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>skip_resname</strong> – list of resnames to skip. Useful to exclude ions water or other ligands from the calculation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mass of molecule in Dalton</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_mass_by_residue">
<span class="sig-name descname"><span class="pre">get_mass_by_residue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_resname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_mass_by_residue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_mass_by_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute protein mass using residues (i.e. account also for atoms not present in the structure)</p>
<p>Sum the average mass all every residue (using a knowledge base of atom masses in Dalton)
The knowledge base can be expanded or edited by adding entries to the molecule’s mass dictionary, e.g. to add the residue “TST” mass in molecule M type: M.knowledge[‘mass_residue’][“TST”]=142.42</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>skip_resname</strong> – list of resnames to skip. Useful to exclude ions water or other ligands from the calculation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mass of molecule in Dalton</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_pdb_data">
<span class="sig-name descname"><span class="pre">get_pdb_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_pdb_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_pdb_data" title="Permalink to this definition">¶</a></dt>
<dd><p>aggregate data and point coordinates, and return in a unique data structure</p>
<p>Returned data is a list containing strings for points data and floats for point coordinates
in the same order as a pdb file, i.e.
ATOM/HETATM, index, name, resname, chain name, residue ID, x, y, z, occupancy, beta factor, atomtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list aggregated data and coordinates for every point, as string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_secondary_structure">
<span class="sig-name descname"><span class="pre">get_secondary_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dssp_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_secondary_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_secondary_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the protein’s secondary structure, calling DSSP
:param dssp_path: DSSP executable (path and filename). If not provided, the default behaviour is to seek for this information in the environment variable DSSPPATH
:returns: numpy array of characters, with one-letter-coded secondary sctructure according to DSSP.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_subset">
<span class="sig-name descname"><span class="pre">get_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#molecule.Molecule" title="molecule.Molecule"><code class="xref py py-func docutils literal notranslate"><span class="pre">Molecule</span></code></a> object containing only the selected atoms and frames</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ixds</strong> – atoms to extract</p></li>
<li><p><strong>conformations</strong> – frames to extract (by default, all)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#molecule.Molecule" title="molecule.Molecule"><code class="xref py py-func docutils literal notranslate"><span class="pre">Molecule</span></code></a> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.get_vdw_density">
<span class="sig-name descname"><span class="pre">get_vdw_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_half_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.get_vdw_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.get_vdw_density" title="Permalink to this definition">¶</a></dt>
<dd><p>generate density map from points based on the van der Waals readius of the atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buff</strong> – Buffer used to create the boundaries of the density map</p></li>
<li><p><strong>step</strong> – Stepsize for creating the density object</p></li>
<li><p><strong>kernel_half_width</strong> – Kernel half width of the gaussian kernel, will be scaled by atom specific sigma</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#density.Density" title="density.Density"><code class="xref py py-func docutils literal notranslate"><span class="pre">Density</span></code></a> object, containing a density map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.guess_chain_split">
<span class="sig-name descname"><span class="pre">guess_chain_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_backbone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.guess_chain_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.guess_chain_split" title="Permalink to this definition">¶</a></dt>
<dd><p>reassign chain name, using distance cutoff (cannot be undone).
If two consecutive atoms are beyond a cutoff, a new chain is assigned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance</strong> – distance cutoff distanceR: no atomtype found!</p></li>
<li><p><strong>use_backbone</strong> – if True, splitting will be performed considering backbone atoms (N and C), all atoms in a sequence otherwise</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.import_gro">
<span class="sig-name descname"><span class="pre">import_gro</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.import_gro"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.import_gro" title="Permalink to this definition">¶</a></dt>
<dd><p>read a gro possibly containing multiple structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – name of .gro file to import</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.import_pdb">
<span class="sig-name descname"><span class="pre">import_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_hetatm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.import_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.import_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>read a pdb (possibly containing containing multiple models).</p>
<p>Models are split according to ENDMDL and END statement.
All alternative coordinates are expected to have the same atoms.
After loading, the first model (M.current_model=0) will be set as active.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdb</strong> – PDB filename</p></li>
<li><p><strong>include_hetatm</strong> – if True, HETATM will be included (they get skipped if False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.import_pqr">
<span class="sig-name descname"><span class="pre">import_pqr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pqr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_hetatm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.import_pqr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.import_pqr" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a pqr (possibly containing containing multiple models).</p>
<p>models are split according to ENDMDL and END statement.
All alternative coordinates are expected to have the same atoms.
After loading, the first model (M.current_model=0) will be set as active.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pqr</strong> – PQR filename</p></li>
<li><p><strong>include_hetatm</strong> – if True, HETATM will be included (they get skipped if False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.know">
<span class="sig-name descname"><span class="pre">know</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.know"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.know" title="Permalink to this definition">¶</a></dt>
<dd><p>return information from knowledge base</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prop</strong> – desired property to extract from knowledge base</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>value associated to requested property, or nan if failed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.match_residue">
<span class="sig-name descname"><span class="pre">match_residue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.match_residue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.match_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares two bb.Molecule() peptide strands and returns the resids within both peptides when the two are homogenous
beyond a certain secondary structure threashold. The default is 5 amino acids (given by sec) in a row must be identical</p>
<p>Useful when aligning PDB structures that have been crystallised separately - so one may be missing the odd residue
or have a few extra at the end.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M2</strong> – The second bb.Molecule() to compare with</p></li>
<li><p><strong>sec</strong> – Number of consecutive amino acids in a row that must match before resid’s are recorded</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.pdb2pqr">
<span class="sig-name descname"><span class="pre">pdb2pqr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.pdb2pqr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.pdb2pqr" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses data from the pdb input into a pqr format. This uses the panda dataframe with the information
regarding atom indexes, types etc. in the self.data files.
It outputs a panda dataframe with the pqr equivilent information. It requires a datafile forcefield input.
The default is the amber14sb forcefield file held within the classes/ folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ff</strong> – name of forcefield text file input that needs to be read to read charges / vdw radii.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Select specific atoms in a multimer un the basis of a text query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_text</strong> – string selecting atoms of interest. Uses the pandas query syntax, can access all columns in the dataframe self.data.</p></li>
<li><p><strong>get_index</strong> – if set to True, returns the indices of selected atoms in self.points array (and self.data)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coordinates of the selected points (in a unique array) and, if get_index is set to true, a list of their indices in subunits’ self.points array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.rmsf_from_beta_factor">
<span class="sig-name descname"><span class="pre">rmsf_from_beta_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.rmsf_from_beta_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.rmsf_from_beta_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate RMSF from atoms beta factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>indices</strong> – indices of atoms of interest. If not set all atoms will be considered.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.s2">
<span class="sig-name descname"><span class="pre">s2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atomname1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'N'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomname2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'H'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.s2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.s2" title="Permalink to this definition">¶</a></dt>
<dd><p>compute s2, given two atoms defining the vector of interest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomname1</strong> – name of the first atom</p></li>
<li><p><strong>atomname2</strong> – name of the second atom</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data numpy array containing information about residues for which measuring has been performed (i.e.[chain, resid])</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>s2 s2 of residues for which both provided input atoms have been found</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.same_residue">
<span class="sig-name descname"><span class="pre">same_residue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.same_residue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.same_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Select atoms having the same residue and chain as a given atom (or list of atoms)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>index</em>) – of atoms of choice (integer of list of integers)</p></li>
<li><p><strong>get_index</strong> – if set to True, returns the indices of selected atoms in self.points array (and self.data)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coordinates of the selected points and, if get_index is set to true, their indices in self.points array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.same_residue_unique">
<span class="sig-name descname"><span class="pre">same_residue_unique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.same_residue_unique"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.same_residue_unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Select atoms having the same residue and chain as a given atom (or list of atoms)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – indices of atoms of choice (integer of list of integers)</p></li>
<li><p><strong>get_index</strong> – if set to True, returns the indices of selected atoms in self.points array (and self.data)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coordinates of the selected points and, if get_index is set to true, their indices in self.points array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.set_data">
<span class="sig-name descname"><span class="pre">set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.set_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.set_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return information about atoms of interest (i.e., slice the data DataFrame)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> – list of indices, if not provided all atom data is returned</p></li>
<li><p><strong>columns</strong> – list of columns (e.g. [“resname”, “resid”, “chain”]), if not provided all columns are returned</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array containing a slice of molecule’s data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.write_gro">
<span class="sig-name descname"><span class="pre">write_gro</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.write_gro"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.write_gro" title="Permalink to this definition">¶</a></dt>
<dd><p>write structure(s) in .gro format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outname</strong> – name of .gro file to be generated.</p></li>
<li><p><strong>index</strong> – indices of atoms to write to file. If empty, all atoms are returned. Index values obtaineable with a call like: index=molecule.atomselect(“A”, [1, 2, 3], “CA”, True)[1]</p></li>
<li><p><strong>conformations</strong> – list of conformation indices to write to file. By default, all conformations will be returned.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.write_pdb">
<span class="sig-name descname"><span class="pre">write_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.write_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.write_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>overload superclass method for writing (multi)pdb.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outname</strong> – name of pdb file to be generated.</p></li>
<li><p><strong>index</strong> – indices of atoms to write to file. If empty, all atoms are returned. Index values obtaineable with a call like: index=molecule.atomselect(“A”, [1, 2, 3], “CA”, True)[1]</p></li>
<li><p><strong>conformations</strong> – list of conformation indices to write to file. By default, a multipdb with all conformations will be produced.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="molecule.Molecule.write_pqr">
<span class="sig-name descname"><span class="pre">write_pqr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/molecule.html#Molecule.write_pqr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molecule.Molecule.write_pqr" title="Permalink to this definition">¶</a></dt>
<dd><p>overload superclass method for writing (multi)pqr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outname</strong> – name of pqr file to be generated.</p></li>
<li><p><strong>index</strong> – indices of atoms to write to file. If empty, all atoms are returned. Index values obtaineable with a call like: index=molecule.atomselect(“A”, [1, 2, 3], “CA”, True)[1]</p></li>
<li><p><strong>conformations</strong> – list of conformation indices to write to file. By default, a multipdb with all conformations will be produced.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="convex-point-clouds">
<h2>Convex Point Clouds<a class="headerlink" href="#convex-point-clouds" title="Permalink to this headline">¶</a></h2>
<p>The following classes allow generating clouds of points arranged according to specific (convex) geometries.
All these classes are subclass of <a class="reference internal" href="#structure.Structure" title="structure.Structure"><code class="xref py py-func docutils literal notranslate"><span class="pre">Structure</span></code></a>.</p>
<span class="target" id="module-convex"></span><dl class="py class">
<dt class="sig sig-object py" id="convex.Cone">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Cone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skew</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts_density_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.09817477042468103</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts_density_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Cone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Cone" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">biobox.classes.structure.Structure</span></code></p>
<p>Create an ensemble of points arranged as a cone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – radius</p></li>
<li><p><strong>h</strong> – height</p></li>
<li><p><strong>skew</strong> – skewing with respect of vertical axis</p></li>
<li><p><strong>radius</strong> – size of the individual points composing it</p></li>
<li><p><strong>pts_density_r</strong> – density of points along the rotation axis (using parametric function for cylinder)</p></li>
<li><p><strong>pts_density_h</strong> – density of points along height (using parametric function for cylinder)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="convex.Cone.ccs">
<span class="sig-name descname"><span class="pre">ccs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Cone.ccs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Cone.ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>compute cone CCS (use analytical solution using surface and gas effect)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCS in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Cone.get_surface">
<span class="sig-name descname"><span class="pre">get_surface</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Cone.get_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Cone.get_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>compute cone surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>surface in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Cone.get_volume">
<span class="sig-name descname"><span class="pre">get_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Cone.get_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Cone.get_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute cone volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>volume in A^3</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="convex.Cylinder">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Cylinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skew</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts_density_u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.09817477042468103</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts_density_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Cylinder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Cylinder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">biobox.classes.structure.Structure</span></code></p>
<p>Create an ensemble of points arranged as an elliptical cylinder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – radius</p></li>
<li><p><strong>h</strong> – height</p></li>
<li><p><strong>squeeze</strong> – create an elliptical base, having axes equal to r and squeeze*r</p></li>
<li><p><strong>skew</strong> – skewing with respect of vertical axis</p></li>
<li><p><strong>radius</strong> – size of the individual points composing it</p></li>
<li><p><strong>density</strong> (<em>pts_density_h</em>) – of points along the u angle (using parametric function for cylinder)</p></li>
<li><p><strong>density</strong> – of points along the v angle (using parametric function for cylinder)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="convex.Cylinder.ccs">
<span class="sig-name descname"><span class="pre">ccs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Cylinder.ccs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Cylinder.ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute cylinder CCS.</p>
<p>Uses Ramanujan approximation for base perimeter. Good, but not perfect for very elliptical cylinders!</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCS in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Cylinder.get_surface">
<span class="sig-name descname"><span class="pre">get_surface</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Cylinder.get_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Cylinder.get_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute cylinder surface.</p>
<p>Uses Ramanujan approximation for base perimeter. Good, but not perfect for very elliptical cylinders!</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>surface in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Cylinder.get_volume">
<span class="sig-name descname"><span class="pre">get_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Cylinder.get_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Cylinder.get_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute cylinder volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>volume in A^3</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="convex.Ellipsoid">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts_density_u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.08726646259971647</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts_density_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.08726646259971647</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Ellipsoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Ellipsoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">biobox.classes.structure.Structure</span></code></p>
<p>Create an ensemble of points arranged as an ellipsoid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – x radius of the ellipsoid</p></li>
<li><p><strong>b</strong> – y radius of the ellipsoid</p></li>
<li><p><strong>c</strong> – z radius of the ellipsoid</p></li>
<li><p><strong>radius</strong> – size of the individual points composing it</p></li>
<li><p><strong>pts_density_u</strong> – This parameter defines the density of points along the u angle (using parametric function for ellipsoid)</p></li>
<li><p><strong>pts_density_v</strong> – This parameter defines the density of points along the v angle (using parametric function for ellipsoid)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="convex.Ellipsoid.ccs">
<span class="sig-name descname"><span class="pre">ccs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Ellipsoid.ccs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Ellipsoid.ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>compute ellipsoid CCS.</p>
<p>Uses analytical approximation to surface area.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>surface in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Ellipsoid.check_inclusion">
<span class="sig-name descname"><span class="pre">check_inclusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Ellipsoid.check_inclusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Ellipsoid.check_inclusion" title="Permalink to this definition">¶</a></dt>
<dd><p>count how many points in the array p are included in the ellipsoid.</p>
<p>overloading of superclass function, which is slower (here we can use the ellipsoid functional form to speed up things)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> – list of points (numpy array)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>quantity of points located inside the ellipsoid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Ellipsoid.get_sphericity">
<span class="sig-name descname"><span class="pre">get_sphericity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Ellipsoid.get_sphericity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Ellipsoid.get_sphericity" title="Permalink to this definition">¶</a></dt>
<dd><p>compute ellipsoid sphericity.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>ellipsoid sphericity</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Ellipsoid.get_surface">
<span class="sig-name descname"><span class="pre">get_surface</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Ellipsoid.get_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Ellipsoid.get_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>compute ellipsoid surface.</p>
<p>Note: using analytical value, uses analytical approximation to surface area</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>surface in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Ellipsoid.get_volume">
<span class="sig-name descname"><span class="pre">get_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Ellipsoid.get_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Ellipsoid.get_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>compute ellipsoid volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>volume in A^3</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="convex.Prism">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Prism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skew</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts_density_u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.09817477042468103</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts_density_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Prism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Prism" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">biobox.classes.structure.Structure</span></code></p>
<p>Create an ensemble of points arranged as a prism (polygonal bottom and top, rectangular sides).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – distance of sides from center of symmetry</p></li>
<li><p><strong>h</strong> – height</p></li>
<li><p><strong>n</strong> – number of side faces</p></li>
<li><p><strong>skew</strong> – skewing with respect of vertical axis</p></li>
<li><p><strong>radius</strong> – size of the individual points composing it</p></li>
<li><p><strong>pts_density_u</strong> – density of points along the r axis (polar coordinates)</p></li>
<li><p><strong>pts_density_h</strong> – the density of points along the vertical axis</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="convex.Prism.ccs">
<span class="sig-name descname"><span class="pre">ccs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Prism.ccs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Prism.ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>compute prism CCS.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCS in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Prism.get_surface">
<span class="sig-name descname"><span class="pre">get_surface</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Prism.get_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Prism.get_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>compute prism surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>surface in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Prism.get_volume">
<span class="sig-name descname"><span class="pre">get_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Prism.get_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Prism.get_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>compute prism volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>volume in A^3</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="convex.Sphere">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sphere_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">960</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Sphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">biobox.classes.structure.Structure</span></code></p>
<p>Create an ensemble of points arranged as a sphere.</p>
<p>using golden spiral to approximate an even distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – radius of the ellipsoid</p></li>
<li><p><strong>radius</strong> – size of the individual points composing it</p></li>
<li><p><strong>n_sphere_point</strong> – This parameter defines the amount of points in the sphere</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="convex.Sphere.ccs">
<span class="sig-name descname"><span class="pre">ccs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Sphere.ccs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Sphere.ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>compute spheroid CCS.</p>
<p>Uses analytical approximation to surface area.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>surface in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Sphere.check_inclusion">
<span class="sig-name descname"><span class="pre">check_inclusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Sphere.check_inclusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Sphere.check_inclusion" title="Permalink to this definition">¶</a></dt>
<dd><p>count how many points in the array p are included in the sphere.</p>
<p>overloading of superclass function, which is slower (here we can use the ellipsoid functional form to speed up things)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> – list of points (numpy array)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>quantity of points located inside the sphere</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Sphere.get_sphericity">
<span class="sig-name descname"><span class="pre">get_sphericity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Sphere.get_sphericity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Sphere.get_sphericity" title="Permalink to this definition">¶</a></dt>
<dd><p>compute sphericity (makes sense only for squeezed spheres, obviously..)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>shape sphericity</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Sphere.get_surface">
<span class="sig-name descname"><span class="pre">get_surface</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Sphere.get_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Sphere.get_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>compute sphere surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>surface in A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Sphere.get_volume">
<span class="sig-name descname"><span class="pre">get_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Sphere.get_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Sphere.get_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>compute ellipsoid volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>volume in A^3</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="convex.Sphere.squeeze">
<span class="sig-name descname"><span class="pre">squeeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deformation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convex.html#Sphere.squeeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#convex.Sphere.squeeze" title="Permalink to this definition">¶</a></dt>
<dd><p>squeeze sphere according to deformation coefficient(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deformation</strong> – deformation coefficient. Can be a float (deformation of one axis), or a list of 2 or 3 floats.</p></li>
<li><p><strong>preserve_volume</strong> – If true and deformation is either a float or a list of 2 floats, correct remaining axes to preserve volume.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-density">
<span id="density"></span><h2>Density<a class="headerlink" href="#module-density" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="density.Density">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Density</span></span><a class="reference internal" href="_modules/density.html#Density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">biobox.classes.structure.Structure</span></code></p>
<p>Subclass of <a class="reference internal" href="#structure.Structure" title="structure.Structure"><code class="xref py py-func docutils literal notranslate"><span class="pre">Structure</span></code></a>, allows importing density map, and transform them in a PDB file containing a collection of spheres placed on the map’s high density regions.</p>
<p>A density map is fully described by the following attributes, stored in the self.properties dictionary:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density</strong> – density map</p></li>
<li><p><strong>delta</strong> – scaling factor for voxels (default is [1, 1, 1] Angstrom)</p></li>
<li><p><strong>size</strong> – dimensions in voxels</p></li>
<li><p><strong>origin</strong> – bottom-left-front corner of the cube</p></li>
<li><p><strong>radius</strong> – radius of points composing the density map</p></li>
<li><p><strong>format</strong> – format name (only dx supported at the moment)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="density.Density.best_threshold">
<span class="sig-name descname"><span class="pre">best_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.782878356</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.best_threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.best_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>If mass and density of object are known, try to filter the map so that the mass is best matched.</p>
<p>search for best threshold using bissection method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>in proteins, an average value of 1.3 g/cm^3 (0.782878356 Da/A^3) can be assumed. Alternatively, the relation density=1.410+0.145*exp(-mass(kDa)/13) can be used.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>1 Da/A^3=1.660538946 g/cm^3</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>1 g/cm^3=0.602214120 Da/A^3</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> – target mass in Da</p></li>
<li><p><strong>density</strong> – target density in Da/A^3</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array reporting tested values and error on mass ([sigma, model_mass-target_mass])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.blur">
<span class="sig-name descname"><span class="pre">blur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.blur"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.blur" title="Permalink to this definition">¶</a></dt>
<dd><p>blur density applying a cubic gaussian kernel of given kernel dimension (cubic grid size).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>cannot be undone</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dimension</strong> – size of the kernel grid.</p></li>
<li><p><strong>sigma</strong> – standard deviation of gaussian kernel.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.export_as_pdb">
<span class="sig-name descname"><span class="pre">export_as_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.export_as_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.export_as_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a pdb file with points where the density exceeds a threshold</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outname</strong> – output file name</p></li>
<li><p><strong>step</strong> – stepsize used to generate the density map</p></li>
<li><p><strong>threshold</strong> – density to be exceeded to generate a point in pdb</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.find_data_from_ccs">
<span class="sig-name descname"><span class="pre">find_data_from_ccs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ccs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.find_data_from_ccs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.find_data_from_ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>map experimental data to given ccs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ccs</strong> – target CCS (in A^2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.find_data_from_sigma">
<span class="sig-name descname"><span class="pre">find_data_from_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.find_data_from_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.find_data_from_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>map experimental data to given threshold</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> – density threshold</p></li>
<li><p><strong>noise_filter</strong> – launch DBSCAN clustering algorithm to detect connected regions in density map. Regions representing less than noise_filter of the total will be removed. This is a ratio, value should be between 0 and 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.find_data_from_volume">
<span class="sig-name descname"><span class="pre">find_data_from_volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.find_data_from_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.find_data_from_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>map experimental data to given volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vol</strong> – volume</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.get_oversampled_points">
<span class="sig-name descname"><span class="pre">get_oversampled_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.get_oversampled_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.get_oversampled_points" title="Permalink to this definition">¶</a></dt>
<dd><p>return points obtained by oversampling the map (doule points on every axis)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sigma</strong> – place points only on voxels having intensity greater than threshold</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>points 3D points placed on voxels having value higher than threshold</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>radius radius of produced points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.get_sigma_from_thresh">
<span class="sig-name descname"><span class="pre">get_sigma_from_thresh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.get_sigma_from_thresh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.get_sigma_from_thresh" title="Permalink to this definition">¶</a></dt>
<dd><p>convert cutoff value from actual threshold to sigma multiple</p>
<p>:param threshold value
:returns sigma multiple</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.get_thresh_from_sigma">
<span class="sig-name descname"><span class="pre">get_thresh_from_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.get_thresh_from_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.get_thresh_from_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>convert cutoff value from sigma multiples into actual threshold</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val</strong> – sigma scaling</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cutoff</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.get_volume">
<span class="sig-name descname"><span class="pre">get_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.get_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.get_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>compute density map volume. This is done by counting the points, and multiplying that by voxels’ volume.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>can be called only after <a class="reference internal" href="#density.Density.place_points" title="density.Density.place_points"><code class="xref py py-func docutils literal notranslate"><span class="pre">place_points</span></code></a> has been called.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>supposes unskewed voxels.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.import_map">
<span class="sig-name descname"><span class="pre">import_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dx'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.import_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.import_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Import density map and fill up the points and properties data structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – name of density file to load</p></li>
<li><p><strong>fileformat</strong> – at the moment supports dx, ccp4, mrc and imod</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.import_numpy">
<span class="sig-name descname"><span class="pre">import_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[1.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">1.]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.import_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.import_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>import a numpy 3D array to allow manipulation as a density map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy 3D array</p></li>
<li><p><strong>origin</strong> – coordinates of bottom left corner of the map</p></li>
<li><p><strong>delta</strong> – voxels’ shape (default is a cubic voxel of 1 Angstrom-long sides).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.place_points">
<span class="sig-name descname"><span class="pre">place_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.place_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.place_points" title="Permalink to this definition">¶</a></dt>
<dd><p>given density information, place points on every voxel above a given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> – intensity threshold value.</p></li>
<li><p><strong>noise_filter</strong> – launch DBSCAN clustering algorithm to detect connected regions in density map. Regions representing less than noise_filter of the total will be removed. This is a ratio, value should be between 0 and 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.return_density_map">
<span class="sig-name descname"><span class="pre">return_density_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.return_density_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.return_density_map" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>density map as 3D numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.scan_threshold">
<span class="sig-name descname"><span class="pre">scan_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.782878356</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.scan_threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.scan_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>if mass and density of object are known, filter the map on a linear scale of threshold values, and compare the obtained mass to the experimental one.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>in proteins, an average value of 1.3 g/cm^3 (0.782878356 Da/A^3) can be assumed. Alternatively, the relation density=1.410+0.145*exp(-mass(kDa)/13) can be used.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>1 Da/A^3=0.602214120 g/cm^3</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> – target mass in Da</p></li>
<li><p><strong>density</strong> – target density in Da/A^3</p></li>
<li><p><strong>sampling_points</strong> – number of measures to perform between min and max intensity in density map</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array reporting tested values and error on mass ([threshold, model_mass-target_mass])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.threshold_vol_ccs">
<span class="sig-name descname"><span class="pre">threshold_vol_ccs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.threshold_vol_ccs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.threshold_vol_ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>return the volume to threshold to CCS relationship</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sampling_points</strong> – number of measures to perform between min and max intensity in density map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array reporting tested values and error on mass ([threshold, model_mass-target_mass])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="density.Density.write_dx">
<span class="sig-name descname"><span class="pre">write_dx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dens.dx'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/density.html#Density.write_dx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#density.Density.write_dx" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a density map in DX format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> – output file name</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Single Structures</a><ul>
<li><a class="reference internal" href="#module-structure">Structure</a></li>
<li><a class="reference internal" href="#module-molecule">Molecule</a></li>
<li><a class="reference internal" href="#convex-point-clouds">Convex Point Clouds</a></li>
<li><a class="reference internal" href="#module-density">Density</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">BiobOx’s documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="assembly.html"
                        title="next chapter">Assemblies</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/structure.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="assembly.html" title="Assemblies"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="BiobOx’s documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">biobox 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Single Structures</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Matteo Degiacomi.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
  </body>
</html>
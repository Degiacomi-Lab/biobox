<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Measures &#8212; biobox 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Assemblies" href="assembly.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="assembly.html" title="Assemblies"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">biobox 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="measures">
<h1>Measures<a class="headerlink" href="#measures" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-biobox.measures.calculators">
<span id="measuring-characteristics"></span><h2>measuring characteristics<a class="headerlink" href="#module-biobox.measures.calculators" title="Permalink to this headline">¶</a></h2>
<p>Functions to measure characteristics of any BiobOx object</p>
<dl class="function">
<dt id="biobox.measures.calculators.ccs">
<code class="descname">ccs</code><span class="sig-paren">(</span><em>M</em>, <em>use_lib=True</em>, <em>impact_path=''</em>, <em>impact_options='-Octree -nRuns 32 -cMode sem -convergence 0.01'</em>, <em>pdbname=''</em>, <em>tjm_scale=False</em>, <em>proberad=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/calculators.html#ccs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.calculators.ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>compute CCS calling either impact.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>M</strong> &#8211; any biobox object</li>
<li><strong>use_lib</strong> &#8211; if true, impact library will be used, if false a system call to impact executable will be performed instead</li>
<li><strong>impact_path</strong> &#8211; by default, the environment variable IMPACTPATH is sought. This allows redirecting to a specific impact root folder.</li>
<li><strong>impact_options</strong> &#8211; flags to be passes to impact executable</li>
<li><strong>pdbname</strong> &#8211; if a file has been already written, impact can be asked to analyze it</li>
<li><strong>tjm_scale</strong> &#8211; if True, CCS value calculated with PA method is scaled to better match trajectory method.</li>
<li><strong>proberad</strong> &#8211; radius of probe. Do find out if your impact library already adds this value by default or not (old ones do)!</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>CCS value in A^2. Error return: -1 = input filename not found, -2 = unknown code for CCS calculation</p>
<p>-3 CCS calculator failed, -4 = parsing of CCS calculation results failed</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="biobox.measures.calculators.rgyr">
<code class="descname">rgyr</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/calculators.html#rgyr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.calculators.rgyr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute radius of gyration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>M</strong> &#8211; any biobox object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">radius of gyration</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="biobox.measures.calculators.sasa">
<code class="descname">sasa</code><span class="sig-paren">(</span><em>M</em>, <em>targets=[]</em>, <em>probe=1.4</em>, <em>n_sphere_point=960</em>, <em>threshold=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/calculators.html#sasa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.calculators.sasa" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the accessible surface area using the Shrake-Rupley algorithm (&#8220;rolling ball method&#8221;)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>M</strong> &#8211; any biobox object</li>
<li><strong>targets</strong> &#8211; indices to be used for surface estimation. By default, all indices are kept into account.</li>
<li><strong>probe</strong> &#8211; radius of the &#8220;rolling ball&#8221;</li>
<li><strong>n_sphere_point</strong> &#8211; number of mesh points per atom</li>
<li><strong>threshold</strong> &#8211; fraction of points in sphere, above which structure points are considered as exposed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">accessible surface area in A^2</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">mesh numpy array containing the found points forming the accessible surface mesh</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">IDs of surface points</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="biobox.measures.calculators.saxs">
<code class="descname">saxs</code><span class="sig-paren">(</span><em>M</em>, <em>crysol_path=''</em>, <em>crysol_options='-lm 20 -ns 500'</em>, <em>pdbname=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/calculators.html#saxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.calculators.saxs" title="Permalink to this definition">¶</a></dt>
<dd><p>compute SAXS curve using crysol (from ATSAS suite)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>M</strong> &#8211; any biobox object</li>
<li><strong>crysol_path</strong> &#8211; path to crysol executable. By default, the environment variable ATSASPATH is sought. This allows redirecting to a specific impact root folder.</li>
<li><strong>crysol_options</strong> &#8211; flags to be passes to impact executable</li>
<li><strong>pdbname</strong> &#8211; if a file has been already written, crysol can be asked to analyze it</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">SAXS curve (nx2 numpy array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="measuring-distances">
<h2>measuring distances<a class="headerlink" href="#measuring-distances" title="Permalink to this headline">¶</a></h2>
<p>Helper functions and classes are available to assess points&#8217; pairwise interactions between points. These are divided in two categories:</p>
<ul class="simple">
<li>straight line (i.e. euclidean distances, van der Waals interactions).</li>
<li>paths (e.g. used to model cross-linking data)</li>
</ul>
<span class="target" id="module-biobox.measures.interaction"></span><p>Helper functions for the calculation of pairwise interactions</p>
<dl class="function">
<dt id="biobox.measures.interaction.distance_matrix">
<code class="descname">distance_matrix</code><span class="sig-paren">(</span><em>points1</em>, <em>points2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/interaction.html#distance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.interaction.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>compute full distance matrix between two points clouds</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>points1</strong> &#8211; nx3 numpy array containing points coordinates</li>
<li><strong>points2</strong> &#8211; mx3 numpy array containing points coordinates</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">nxm distance matrix (numpy array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="biobox.measures.interaction.get_neighbors">
<code class="descname">get_neighbors</code><span class="sig-paren">(</span><em>dist</em>, <em>cutoff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/interaction.html#get_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.interaction.get_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>detect interfacing points (couples at less than a certain cutoff distance)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dist</strong> &#8211; distance matrix</li>
<li><strong>cutoff</strong> &#8211; maximal distance at which lennard-jones interaction is considered</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of interacting couples</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="biobox.measures.interaction.lennard_jones">
<code class="descname">lennard_jones</code><span class="sig-paren">(</span><em>points1</em>, <em>points2</em>, <em>epsilon=1.0</em>, <em>sigma=2.7</em>, <em>cutoff=12.0</em>, <em>coeff1=9</em>, <em>coeff2=6</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/interaction.html#lennard_jones"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.interaction.lennard_jones" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute m-n lennard-jones potential between two ensembles of points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>points1</strong> &#8211; nx3 numpy array containing points coordinates</li>
<li><strong>points2</strong> &#8211; mx3 numpy array containing points coordinates</li>
<li><strong>epsilon</strong> &#8211; epsilon parameter</li>
<li><strong>sigma</strong> &#8211; sigma parameter</li>
<li><strong>cutoff</strong> &#8211; maximal distance at which lennard-jones interaction is considered</li>
<li><strong>coeff1</strong> &#8211; coefficient of repulsive term (m coefficient)</li>
<li><strong>coeff2</strong> &#8211; coefficient of attractive term (n coefficient)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">m-n lennard-jones potential (kJ/mol)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-biobox.measures.path"></span><dl class="class">
<dt id="biobox.measures.path.Path">
<em class="property">class </em><code class="descname">Path</code><span class="sig-paren">(</span><em>points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Path" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for finding shortest paths between points in a point cloud (typically a <a class="reference internal" href="structure.html#structure.Structure" title="structure.Structure"><code class="xref py py-func docutils literal"><span class="pre">Structure</span></code></a> object).</p>
<p>Two algorithms are implemented: A* and Theta*.
In order to deal with lists of links within the same dataset, two methodologies are offered, global or local.</p>
<ul class="simple">
<li>global builds a grid around the whole ensemble of points once, and every subsequent distance measure is performed on the same grid.</li>
<li>local a local grid is displaced to surround the points to be linked.</li>
</ul>
<p>Global take longer to initialize, and is more memory intensive, but subsequent measures are quick.
Local takes less memory, but individual measures take more time to be performed.</p>
<p>An accessibility graph must be initially created around the provided points cloud.
This is a mesh where none of its nodes clashes with any of the provided point in the cloud.
After instantiation, <code class="xref py py-func docutils literal"><span class="pre">setup_local_search</span></code> or <code class="xref py py-func docutils literal"><span class="pre">setup_global_search</span></code> must first be called (depending on whether one wants to generate a single grid encompassing all the protein, or a smaller, moving grid).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>points</strong> &#8211; points for representing obstacles.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="biobox.measures.path.Path.a_star">
<code class="descname">a_star</code><span class="sig-paren">(</span><em>start</em>, <em>goal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.a_star"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Path.a_star" title="Permalink to this definition">¶</a></dt>
<dd><p>A* algorithm, find path connecting two points in the graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>start</strong> &#8211; starting point (flattened coordinate of a graph grid point).</li>
<li><strong>goal</strong> &#8211; end point (flattened coordinate of a graph grid point).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Path.lazy_theta_star">
<code class="descname">lazy_theta_star</code><span class="sig-paren">(</span><em>start</em>, <em>goal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.lazy_theta_star"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Path.lazy_theta_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Lazy Theta* algorithm (better than Theta* in terms of amount of line-of-sight tests), find path connecting two points in the graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>start</strong> &#8211; starting point (flattened coordinate of a graph grid point).</li>
<li><strong>goal</strong> &#8211; end point (flattened coordinate of a graph grid point).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Path.search_path">
<code class="descname">search_path</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>method='theta'</em>, <em>get_path=True</em>, <em>update_grid=True</em>, <em>test_los=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.search_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Path.search_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the shortest accessible path between two points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>start</strong> &#8211; coordinates of starting point</li>
<li><strong>end</strong> &#8211; coordinates of target point</li>
<li><strong>method</strong> &#8211; can be theta or astar</li>
<li><strong>get_path</strong> &#8211; return full path (not only waypoints)</li>
<li><strong>update_grid</strong> &#8211; if True, grid will be recalculated (for local search only)</li>
<li><strong>test_los</strong> &#8211; if true, a line of sight postprocessing will be performed to make paths straighter</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Path.setup_global_search">
<code class="descname">setup_global_search</code><span class="sig-paren">(</span><em>step=1.0</em>, <em>maxdist=34</em>, <em>use_hull=True</em>, <em>boundaries=[]</em>, <em>cloud=array([]</em>, <em>dtype=float64)</em>, <em>params=array([]</em>, <em>dtype=float64)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.setup_global_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Path.setup_global_search" title="Permalink to this definition">¶</a></dt>
<dd><p>setup Path to perform path search using the a global grid wrapping all the obtacles region.
This method (or <code class="xref py py-func docutils literal"><span class="pre">setup_local_search</span></code>) must be called before and path detection can be lauched with <code class="xref py py-func docutils literal"><span class="pre">search_path</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>step</strong> &#8211; grid step size.</li>
<li><strong>maxdist</strong> &#8211; clash detection threshold</li>
<li><strong>use_hull</strong> &#8211; if True, points not laying within the convex hull wrapping around obtacles will be excluded</li>
<li><strong>boundaries</strong> &#8211; build a grid within the desired box boundaries (if defined, maxdist parameter is ignored)</li>
<li><strong>cloud</strong> &#8211; build a grid using a points cloud as extrema for the construction of the box. If defined, maxdist and boundaries parameters are ignored.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Path.setup_local_search">
<code class="descname">setup_local_search</code><span class="sig-paren">(</span><em>step=1.0</em>, <em>maxdist=28</em>, <em>params=array([]</em>, <em>dtype=float64)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.setup_local_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Path.setup_local_search" title="Permalink to this definition">¶</a></dt>
<dd><p>setup Path to perform path search using the local grid method.
This method (or <code class="xref py py-func docutils literal"><span class="pre">setup_global_search</span></code>) must be called before and path detection can be launched with <code class="xref py py-func docutils literal"><span class="pre">search_path</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>step</strong> &#8211; grid step size</li>
<li><strong>maxdist</strong> &#8211; clash detection threshold</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Path.smooth">
<code class="descname">smooth</code><span class="sig-paren">(</span><em>chain</em>, <em>move_angle_thresh=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Path.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility method aimed at smoothing a chain produced by A* or Theta*, to make it less angular.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chain</strong> &#8211; numpy array containing the list of points composing the path</li>
<li><strong>move_angle_thresh</strong> &#8211; if angle between three consecutive points is greater than this threshold, smoothing is performed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">smoothed chain (3xN numpy array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Path.theta_star">
<code class="descname">theta_star</code><span class="sig-paren">(</span><em>start</em>, <em>goal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.theta_star"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Path.theta_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Theta* algorithm, find path connecting two points in the accessibility graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>start</strong> &#8211; starting point (flattened coordinate of a graph grid point).</li>
<li><strong>goal</strong> &#8211; end point (flattened coordinate of a graph grid point).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Path.write_grid">
<code class="descname">write_grid</code><span class="sig-paren">(</span><em>filename='grid.pdb'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.write_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Path.write_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the accessibility graph to a PBB file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> &#8211; output file name</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="biobox.measures.path.Xlink">
<em class="property">class </em><code class="descname">Xlink</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Xlink" title="Permalink to this definition">¶</a></dt>
<dd><p>subclass of <code class="xref py py-func docutils literal"><span class="pre">Path</span></code>, measure cross-linking distance between atom pairs in a molecule.</p>
<ul class="simple">
<li>after instantiation, call first <code class="xref py py-func docutils literal"><span class="pre">set_clashing_atoms</span></code> to define molecule&#8217;s atoms of interest for clash detection.</li>
<li>Subsequently, call either <code class="xref py py-func docutils literal"><span class="pre">setup_local_search</span></code> or <code class="xref py py-func docutils literal"><span class="pre">setup_local_search</span></code> to prepare the points grid used for path detection.</li>
<li>Physical distances between a list of atom indices can be finally computed with <code class="xref py py-func docutils literal"><span class="pre">distance_matrix</span></code> or, between two atoms only, with <code class="xref py py-func docutils literal"><span class="pre">search_path</span></code>.</li>
</ul>
<p>If molecule contains multiple conformations, conformation i can be chosen by calling Xlink.molecule.set_current(i) before performing the procedure described in superclass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molecule</strong> &#8211; <a class="reference internal" href="structure.html#molecule.Molecule" title="molecule.Molecule"><code class="xref py py-func docutils literal"><span class="pre">Molecule</span></code></a> instance</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="biobox.measures.path.Xlink.distance_matrix">
<code class="descname">distance_matrix</code><span class="sig-paren">(</span><em>indices</em>, <em>method='theta'</em>, <em>get_path=False</em>, <em>smooth=True</em>, <em>verbose=False</em>, <em>test_los=True</em>, <em>flexible_sidechain=False</em>, <em>sphere_pts_surf=4.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.distance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Xlink.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>compute distance matrix between provided indices.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>indices</strong> &#8211; atoms indices (within the data structure, not the original pdb file). Get the indices via molecule.atomselect(...) command.</li>
<li><strong>method</strong> &#8211; can be &#8220;theta&#8221; or &#8220;astar&#8221;.</li>
<li><strong>get_path</strong> &#8211; if true, a list containing all the paths is also returned</li>
<li><strong>smooth</strong> &#8211; if True, path will be refined to make turns less angular.</li>
<li><strong>verbose</strong> &#8211; if True, the algorithm will dump text in console</li>
<li><strong>sphere_pts_surf</strong> &#8211; surface occupied per sphere point, in A2. The smaller, the higher the points density</li>
<li><strong>test_los</strong> &#8211; if true, a line of sight postprocessing will be performed to make paths straighter</li>
<li><strong>flexible_sidechain</strong> &#8211; if True, the selected atoms will be rotated around their associated CA, in order to scan for alternative sidechain arrangements. A sphere of clash-free alternative conformations is generated, and the shortest distance accounting for all these different possibilities is returned. Note that this method is computationally expensive.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">distance matrix (numpy 2d array). matrix will contain -1 if atoms are too far, and -2 if one of the two atoms is buried. If get_path is True, a list of paths is also returned (format: [[id1, id2], [path]]).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Xlink.set_clashing_atoms">
<code class="descname">set_clashing_atoms</code><span class="sig-paren">(</span><em>atoms=[]</em>, <em>densify=True</em>, <em>atoms_vdw=False</em>, <em>points=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.set_clashing_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Xlink.set_clashing_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>define atoms to consider for clash detection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>atoms</strong> &#8211; atomnames to consider for clash detection. If undefined, protein backbone and C beta will be considered.</li>
<li><strong>densify</strong> &#8211; if True, all atoms not solvent exposed will be considered for clash detection.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Xlink.setup_global_search">
<code class="descname">setup_global_search</code><span class="sig-paren">(</span><em>step=1.0</em>, <em>maxdist=28</em>, <em>use_hull=False</em>, <em>boundaries=[]</em>, <em>cloud=array([]</em>, <em>dtype=float64)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.setup_global_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Xlink.setup_global_search" title="Permalink to this definition">¶</a></dt>
<dd><p>setup Path to perform path search using the a global grid wrapping all the obtacles region.
This method (or <code class="xref py py-func docutils literal"><span class="pre">setup_local_search</span></code>) must be called before and path detection can be lauched with <code class="xref py py-func docutils literal"><span class="pre">search_path</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>step</strong> &#8211; grid step size.</li>
<li><strong>maxdist</strong> &#8211; clash detection threshold</li>
<li><strong>use_hull</strong> &#8211; if True, points not laying within the convex hull wrapping around obtacles will be excluded</li>
<li><strong>boundaries</strong> &#8211; build a grid within the desired box boundaries (if defined, maxdist parameter is ignored)</li>
<li><strong>cloud</strong> &#8211; build a grid using a points cloud as extrema for the construction of the box. If defined, maxdist and boundaries parameters are ignored.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Xlink.setup_local_search">
<code class="descname">setup_local_search</code><span class="sig-paren">(</span><em>step=1.0</em>, <em>maxdist=28</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.setup_local_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Xlink.setup_local_search" title="Permalink to this definition">¶</a></dt>
<dd><p>setup Path to perform path search using the local grid method.</p>
<p>This method (or <code class="xref py py-func docutils literal"><span class="pre">setup_global_search</span></code>) must be called before and path detection can be launched with <code class="xref py py-func docutils literal"><span class="pre">search_path</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>step</strong> &#8211; grid step size</li>
<li><strong>maxdist</strong> &#8211; clash detection threshold</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="biobox.measures.path.Xlink.write_protein_points">
<code class="descname">write_protein_points</code><span class="sig-paren">(</span><em>filename='protein_points.pdb'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.write_protein_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#biobox.measures.path.Xlink.write_protein_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the points selected for clash detection into a pdb file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> &#8211; output file name</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Measures</a><ul>
<li><a class="reference internal" href="#module-biobox.measures.calculators">measuring characteristics</a></li>
<li><a class="reference internal" href="#measuring-distances">measuring distances</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="assembly.html"
                        title="previous chapter">Assemblies</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.html"
                        title="next chapter">Examples</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/measures.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="assembly.html" title="Assemblies"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">biobox 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Matteo Degiacomi.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>
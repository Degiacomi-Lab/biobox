
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Measures &#8212; biobox 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Assemblies" href="assembly.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="assembly.html" title="Assemblies"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">biobox 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Measures</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="measures">
<h1>Measures<a class="headerlink" href="#measures" title="Permalink to this headline">¶</a></h1>
<section id="module-biobox.measures.calculators">
<span id="measuring-characteristics"></span><h2>measuring characteristics<a class="headerlink" href="#module-biobox.measures.calculators" title="Permalink to this headline">¶</a></h2>
<p>Functions to measure characteristics of any BiobOx object</p>
<dl class="py function">
<dt class="sig sig-object py" id="biobox.measures.calculators.ccs">
<span class="sig-name descname"><span class="pre">ccs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impact_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impact_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-Octree</span> <span class="pre">-nRuns</span> <span class="pre">32</span> <span class="pre">-cMode</span> <span class="pre">sem</span> <span class="pre">-convergence</span> <span class="pre">0.01'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdbname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tjm_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proberad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/calculators.html#ccs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.calculators.ccs" title="Permalink to this definition">¶</a></dt>
<dd><p>compute CCS calling either impact.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> – any biobox object</p></li>
<li><p><strong>use_lib</strong> – if true, impact library will be used, if false a system call to impact executable will be performed instead</p></li>
<li><p><strong>impact_path</strong> – by default, the environment variable IMPACTPATH is sought. This allows redirecting to a specific impact root folder.</p></li>
<li><p><strong>impact_options</strong> – flags to be passes to impact executable</p></li>
<li><p><strong>pdbname</strong> – if a file has been already written, impact can be asked to analyze it</p></li>
<li><p><strong>tjm_scale</strong> – if True, CCS value calculated with PA method is scaled to better match trajectory method.</p></li>
<li><p><strong>proberad</strong> – radius of probe. Do find out if your impact library already adds this value by default or not (old ones do)!</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>CCS value in A^2. Error return: -1 = input filename not found, -2 = unknown code for CCS calculation</p>
<p>-3 CCS calculator failed, -4 = parsing of CCS calculation results failed</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biobox.measures.calculators.rgyr">
<span class="sig-name descname"><span class="pre">rgyr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/calculators.html#rgyr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.calculators.rgyr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute radius of gyration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> – any biobox object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>radius of gyration</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biobox.measures.calculators.sasa">
<span class="sig-name descname"><span class="pre">sasa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sphere_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">960</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/calculators.html#sasa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.calculators.sasa" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the accessible surface area using the Shrake-Rupley algorithm (“rolling ball method”)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> – any biobox object</p></li>
<li><p><strong>targets</strong> – indices to be used for surface estimation. By default, all indices are kept into account.</p></li>
<li><p><strong>probe</strong> – radius of the “rolling ball”</p></li>
<li><p><strong>n_sphere_point</strong> – number of mesh points per atom</p></li>
<li><p><strong>threshold</strong> – fraction of points in sphere, above which structure points are considered as exposed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>accessible surface area in A^2</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>mesh numpy array containing the found points forming the accessible surface mesh</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>IDs of surface points</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biobox.measures.calculators.saxs">
<span class="sig-name descname"><span class="pre">saxs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crysol_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crysol_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-lm</span> <span class="pre">20</span> <span class="pre">-ns</span> <span class="pre">500'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdbname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/calculators.html#saxs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.calculators.saxs" title="Permalink to this definition">¶</a></dt>
<dd><p>compute SAXS curve using crysol (from ATSAS suite)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> – any biobox object</p></li>
<li><p><strong>crysol_path</strong> – path to crysol executable. If not provided, the environment variable ATSASPATH is sought instead. This allows redirecting to a specific ATSAS bin folder.</p></li>
<li><p><strong>crysol_options</strong> – flags to be passes to impact executable</p></li>
<li><p><strong>pdbname</strong> – if a file has been already written, crysol can be asked to analyze it</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SAXS curve (nx2 numpy array)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="measuring-distances">
<h2>measuring distances<a class="headerlink" href="#measuring-distances" title="Permalink to this headline">¶</a></h2>
<p>Helper functions and classes are available to assess points’ pairwise interactions between points. These are divided in two categories:</p>
<ul class="simple">
<li><p>straight line (i.e. euclidean distances, van der Waals interactions).</p></li>
<li><p>paths (e.g. used to model cross-linking data)</p></li>
</ul>
<span class="target" id="module-biobox.measures.interaction"></span><p>Helper functions for the calculation of pairwise interactions</p>
<dl class="py function">
<dt class="sig sig-object py" id="biobox.measures.interaction.distance_matrix">
<span class="sig-name descname"><span class="pre">distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/interaction.html#distance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.interaction.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>compute full distance matrix between two points clouds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points1</strong> – nx3 numpy array containing points coordinates</p></li>
<li><p><strong>points2</strong> – mx3 numpy array containing points coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nxm distance matrix (numpy array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biobox.measures.interaction.get_neighbors">
<span class="sig-name descname"><span class="pre">get_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/interaction.html#get_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.interaction.get_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>detect interfacing points (couples at less than a certain cutoff distance)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist</strong> – distance matrix</p></li>
<li><p><strong>cutoff</strong> – maximal distance at which lennard-jones interaction is considered</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of interacting couples</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biobox.measures.interaction.lennard_jones">
<span class="sig-name descname"><span class="pre">lennard_jones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeff1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeff2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/interaction.html#lennard_jones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.interaction.lennard_jones" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute m-n lennard-jones potential between two ensembles of points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points1</strong> – nx3 numpy array containing points coordinates</p></li>
<li><p><strong>points2</strong> – mx3 numpy array containing points coordinates</p></li>
<li><p><strong>epsilon</strong> – epsilon parameter</p></li>
<li><p><strong>sigma</strong> – sigma parameter</p></li>
<li><p><strong>cutoff</strong> – maximal distance at which lennard-jones interaction is considered</p></li>
<li><p><strong>coeff1</strong> – coefficient of repulsive term (m coefficient)</p></li>
<li><p><strong>coeff2</strong> – coefficient of attractive term (n coefficient)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>m-n lennard-jones potential (kJ/mol)</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-biobox.measures.path"></span><dl class="py class">
<dt class="sig sig-object py" id="biobox.measures.path.Path">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Path" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for finding shortest paths between points in a point cloud (typically a <a class="reference internal" href="structure.html#structure.Structure" title="structure.Structure"><code class="xref py py-func docutils literal notranslate"><span class="pre">Structure</span></code></a> object).</p>
<p>Two algorithms are implemented: A* and Theta*.
In order to deal with lists of links within the same dataset, two methodologies are offered, global or local.</p>
<ul class="simple">
<li><p>global builds a grid around the whole ensemble of points once, and every subsequent distance measure is performed on the same grid.</p></li>
<li><p>local a local grid is displaced to surround the points to be linked.</p></li>
</ul>
<p>Global take longer to initialize, and is more memory intensive, but subsequent measures are quick.
Local takes less memory, but individual measures take more time to be performed.</p>
<p>An accessibility graph must be initially created around the provided points cloud.
This is a mesh where none of its nodes clashes with any of the provided point in the cloud.
After instantiation, <code class="xref py py-func docutils literal notranslate"><span class="pre">setup_local_search</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">setup_global_search</span></code> must first be called (depending on whether one wants to generate a single grid encompassing all the protein, or a smaller, moving grid).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>points</strong> – points for representing obstacles.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Path.a_star">
<span class="sig-name descname"><span class="pre">a_star</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.a_star"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Path.a_star" title="Permalink to this definition">¶</a></dt>
<dd><p>A* algorithm, find path connecting two points in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – starting point (flattened coordinate of a graph grid point).</p></li>
<li><p><strong>goal</strong> – end point (flattened coordinate of a graph grid point).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Path.lazy_theta_star">
<span class="sig-name descname"><span class="pre">lazy_theta_star</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.lazy_theta_star"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Path.lazy_theta_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Lazy Theta* algorithm (better than Theta* in terms of amount of line-of-sight tests), find path connecting two points in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – starting point (flattened coordinate of a graph grid point).</p></li>
<li><p><strong>goal</strong> – end point (flattened coordinate of a graph grid point).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Path.search_path">
<span class="sig-name descname"><span class="pre">search_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'theta'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_los</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.search_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Path.search_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the shortest accessible path between two points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – coordinates of starting point</p></li>
<li><p><strong>end</strong> – coordinates of target point</p></li>
<li><p><strong>method</strong> – can be theta or astar</p></li>
<li><p><strong>get_path</strong> – return full path (not only waypoints)</p></li>
<li><p><strong>update_grid</strong> – if True, grid will be recalculated (for local search only)</p></li>
<li><p><strong>test_los</strong> – if true, a line of sight postprocessing will be performed to make paths straighter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Path.setup_global_search">
<span class="sig-name descname"><span class="pre">setup_global_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">34</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_hull</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundaries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cloud</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.setup_global_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Path.setup_global_search" title="Permalink to this definition">¶</a></dt>
<dd><p>setup Path to perform path search using the a global grid wrapping all the obtacles region.
This method (or <code class="xref py py-func docutils literal notranslate"><span class="pre">setup_local_search</span></code>) must be called before and path detection can be lauched with <code class="xref py py-func docutils literal notranslate"><span class="pre">search_path</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> – grid step size.</p></li>
<li><p><strong>maxdist</strong> – clash detection threshold</p></li>
<li><p><strong>use_hull</strong> – if True, points not laying within the convex hull wrapping around obtacles will be excluded</p></li>
<li><p><strong>boundaries</strong> – build a grid within the desired box boundaries (if defined, maxdist parameter is ignored)</p></li>
<li><p><strong>cloud</strong> – build a grid using a points cloud as extrema for the construction of the box. If defined, maxdist and boundaries parameters are ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Path.setup_local_search">
<span class="sig-name descname"><span class="pre">setup_local_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.setup_local_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Path.setup_local_search" title="Permalink to this definition">¶</a></dt>
<dd><p>setup Path to perform path search using the local grid method.
This method (or <code class="xref py py-func docutils literal notranslate"><span class="pre">setup_global_search</span></code>) must be called before and path detection can be launched with <code class="xref py py-func docutils literal notranslate"><span class="pre">search_path</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> – grid step size</p></li>
<li><p><strong>maxdist</strong> – clash detection threshold</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Path.smooth">
<span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_angle_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Path.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility method aimed at smoothing a chain produced by A* or Theta*, to make it less angular.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain</strong> – numpy array containing the list of points composing the path</p></li>
<li><p><strong>move_angle_thresh</strong> – if angle between three consecutive points is greater than this threshold, smoothing is performed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>smoothed chain (3xN numpy array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Path.theta_star">
<span class="sig-name descname"><span class="pre">theta_star</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.theta_star"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Path.theta_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Theta* algorithm, find path connecting two points in the accessibility graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – starting point (flattened coordinate of a graph grid point).</p></li>
<li><p><strong>goal</strong> – end point (flattened coordinate of a graph grid point).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Path.write_grid">
<span class="sig-name descname"><span class="pre">write_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grid.pdb'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Path.write_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Path.write_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the accessibility graph to a PBB file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – output file name</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="biobox.measures.path.Xlink">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Xlink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Xlink" title="Permalink to this definition">¶</a></dt>
<dd><p>subclass of <code class="xref py py-func docutils literal notranslate"><span class="pre">Path</span></code>, measure cross-linking distance between atom pairs in a molecule.</p>
<ul class="simple">
<li><p>after instantiation, call first <code class="xref py py-func docutils literal notranslate"><span class="pre">set_clashing_atoms</span></code> to define molecule’s atoms of interest for clash detection.</p></li>
<li><p>Subsequently, call either <code class="xref py py-func docutils literal notranslate"><span class="pre">setup_local_search</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">setup_local_search</span></code> to prepare the points grid used for path detection.</p></li>
<li><p>Physical distances between a list of atom indices can be finally computed with <code class="xref py py-func docutils literal notranslate"><span class="pre">distance_matrix</span></code> or, between two atoms only, with <code class="xref py py-func docutils literal notranslate"><span class="pre">search_path</span></code>.</p></li>
</ul>
<p>If molecule contains multiple conformations, conformation i can be chosen by calling Xlink.molecule.set_current(i) before performing the procedure described in superclass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> – <a class="reference internal" href="structure.html#molecule.Molecule" title="molecule.Molecule"><code class="xref py py-func docutils literal notranslate"><span class="pre">Molecule</span></code></a> instance</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Xlink.distance_matrix">
<span class="sig-name descname"><span class="pre">distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'theta'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_los</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flexible_sidechain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sphere_pts_surf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.distance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Xlink.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>compute distance matrix between provided indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> – atoms indices (within the data structure, not the original pdb file). Get the indices via molecule.atomselect(…) command.</p></li>
<li><p><strong>method</strong> – can be “theta” or “astar”.</p></li>
<li><p><strong>get_path</strong> – if true, a list containing all the paths is also returned</p></li>
<li><p><strong>smooth</strong> – if True, path will be refined to make turns less angular.</p></li>
<li><p><strong>verbose</strong> – if True, the algorithm will dump text in console</p></li>
<li><p><strong>sphere_pts_surf</strong> – surface occupied per sphere point, in A2. The smaller, the higher the points density</p></li>
<li><p><strong>test_los</strong> – if true, a line of sight postprocessing will be performed to make paths straighter</p></li>
<li><p><strong>flexible_sidechain</strong> – if True, the selected atoms will be rotated around their associated CA, in order to scan for alternative sidechain arrangements. A sphere of clash-free alternative conformations is generated, and the shortest distance accounting for all these different possibilities is returned. Note that this method is computationally expensive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>distance matrix (numpy 2d array). matrix will contain -1 if atoms are too far, and -2 if one of the two atoms is buried. If get_path is True, a list of paths is also returned (format: [[id1, id2], [path]]).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Xlink.set_clashing_atoms">
<span class="sig-name descname"><span class="pre">set_clashing_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">densify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_vdw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.set_clashing_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Xlink.set_clashing_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>define atoms to consider for clash detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> – atomnames to consider for clash detection. If undefined, protein backbone and C beta will be considered.</p></li>
<li><p><strong>densify</strong> – if True, all atoms not solvent exposed will be considered for clash detection.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Xlink.setup_global_search">
<span class="sig-name descname"><span class="pre">setup_global_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_hull</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundaries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cloud</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.setup_global_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Xlink.setup_global_search" title="Permalink to this definition">¶</a></dt>
<dd><p>setup Path to perform path search using the a global grid wrapping all the obtacles region.
This method (or <code class="xref py py-func docutils literal notranslate"><span class="pre">setup_local_search</span></code>) must be called before and path detection can be lauched with <code class="xref py py-func docutils literal notranslate"><span class="pre">search_path</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> – grid step size.</p></li>
<li><p><strong>maxdist</strong> – clash detection threshold</p></li>
<li><p><strong>use_hull</strong> – if True, points not laying within the convex hull wrapping around obtacles will be excluded</p></li>
<li><p><strong>boundaries</strong> – build a grid within the desired box boundaries (if defined, maxdist parameter is ignored)</p></li>
<li><p><strong>cloud</strong> – build a grid using a points cloud as extrema for the construction of the box. If defined, maxdist and boundaries parameters are ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Xlink.setup_local_search">
<span class="sig-name descname"><span class="pre">setup_local_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.setup_local_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Xlink.setup_local_search" title="Permalink to this definition">¶</a></dt>
<dd><p>setup Path to perform path search using the local grid method.</p>
<p>This method (or <code class="xref py py-func docutils literal notranslate"><span class="pre">setup_global_search</span></code>) must be called before and path detection can be launched with <code class="xref py py-func docutils literal notranslate"><span class="pre">search_path</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> – grid step size</p></li>
<li><p><strong>maxdist</strong> – clash detection threshold</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biobox.measures.path.Xlink.write_protein_points">
<span class="sig-name descname"><span class="pre">write_protein_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein_points.pdb'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/biobox/measures/path.html#Xlink.write_protein_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biobox.measures.path.Xlink.write_protein_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the points selected for clash detection into a pdb file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – output file name</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Measures</a><ul>
<li><a class="reference internal" href="#module-biobox.measures.calculators">measuring characteristics</a></li>
<li><a class="reference internal" href="#measuring-distances">measuring distances</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="assembly.html"
                        title="previous chapter">Assemblies</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.html"
                        title="next chapter">Examples</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/measures.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="assembly.html" title="Assemblies"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">biobox 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Measures</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Matteo Degiacomi.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
  </body>
</html>